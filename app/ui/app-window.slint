import {
    Button,
    VerticalBox,
    HorizontalBox,
    GridBox,
} from "std-widgets.slint";

export struct NodeStatus {
    running: bool,
    okay: bool,
}


component NodeButton inherits Rectangle {
    in property <NodeStatus> node_status;
    callback run_node(bool);

    property <bool> query_running: node_status.running;

    property <int> padd:  5;
    // function & pure function

    background: node_status.okay ? gray : yellowgreen;
    border-radius: self.height / 2;

    button_knob := Rectangle {
        height: root.height - padd * 2px;
        width: self.height;
        border-radius: self.height / 2;
        x: query_running ? padd * 1px : root.width - padd * 1px - self.width;
        animate x, background {
            easing: ease-in;
            duration: 100ms;
        }
        y: padd * 1px;
        background: node_status.running ? green : darkgray;

        Rectangle {
            property <int> ipad: 5;
            width: button_knob.width - ipad * 2px;
            height: self.width;
            border-radius: self.width / 2;
            y: ipad * 1px;
            x: ipad * 1px;
            background: button_knob.background.brighter(0.1);
        }
    }

    TouchArea {
        clicked => {
            query_running = !query_running;
            run_node(query_running);
        }
    }
}

component StatusPage {
    callback run_node(bool);
    in property <NodeStatus> node_status;
    // in property <string> device_name;
    // in property <int> connected_devices;
    // in property <color> device_color;

    VerticalLayout {
        NodeButton {
            node_status: node_status;
            width: root.width;
            height: root.width / 2;
            run_node(val) => root.run_node(val);
        }
    }
}

export component MainWindow inherits Window {
    in property <NodeStatus> node_status;
    height: 250px;
    width: 200px;
    VerticalBox {
        StatusPage {
            node_status: node_status;
        }
    }
}
